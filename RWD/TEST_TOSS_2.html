<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>線上擲筊</title>
    <link rel="stylesheet" type="text/css" href="style.css">

    <link href="Content/styles_toss_2.css" rel="stylesheet" />

</head>
<body>
    <div class="get-result">
        <a id="go" href="#">請示</a>

        <div class="hide">

            <div id="r1" class="r">
                <div class="all" id="all">
                    <div class="left"><span></span></div>
                    <div class="right"><span></span></div>
                </div>
            </div>
            <div id="r2" class="r">
                <div class="all" id="all">
                    <div class="left"></div>
                    <div class="right"></div>
                </div>
            </div>
            <div id="r3" class="r">
                <div class="all" id="all">
                    <div class="left"></div>
                    <div class="right"><span></span></div>
                </div>
            </div>
            <div id="r4" class="r">
                <div class="all" id="all">
                    <div class="left"><span></span></div>
                    <div class="right"></div>
                </div>
            </div>
        </div>

        <div id="last-div">
            心誠則靈<br>要有信心<br>再擲一次
        </div>
    </div>
    <script src="Scripts/jquery-3.6.1.min.js"></script>
    <script src="Scripts/bootstrap.bundle.min.js"></script>
    <script>
$(document).ready(function () {
            var all,
                randomed;

            all = generateAll();
            randomed = generateRandomed(all);

            $("#go").on("click", function (evt) {
                evt.preventDefault();
                randomed = doNext(all, randomed);
            });
});

function generateAll() {
            // Generates the array of "all" divs to work on
            var a = [];
            var divs = $(".hide > div.r");
            for (var i = 1; i <= divs.length; i++) {
                a.push(i);
            }
            console.log("總區塊: " + a);
            return a;
}

function generateRandomed(all) {
            // Randomizes the original array
            randomed = fisherYates(all);
            console.log("隨機順序: " + randomed);
            return randomed;
}

function doNext(all, randomed) {
            $(".r, #last-div").hide();

            if (randomed.length < 1) {
                console.log("顯示心誠則靈");
                $("#last-div").show();
                randomed = generateRandomed(all);
            } else {
                var next = randomed.shift();
                var selector = "#r" + next;
                console.log("顯示 " + selector);
                $(selector).show();
                console.log("剩下: " + randomed);
            }

            return randomed;
}

// Randomizes an array and returns the new one (doesn't modify original)
function fisherYates(myArray) {
            var return_arr = myArray.slice(0);
            var i = return_arr.length;
            if (i == 0) return false;
            while (--i) {
                var j = Math.floor(Math.random() * (i + 1));
                var tempi = return_arr[i];
                var tempj = return_arr[j];
                return_arr[i] = tempj;
                return_arr[j] = tempi;
            }
            return return_arr;
}


    </script>
</body>
</html>
